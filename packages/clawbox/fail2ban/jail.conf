# Fail2ban configuration — ClawBox
# ClawSentinel v0.1.0
# Protects OpenClaw gateway from brute force and abuse

[DEFAULT]
# Ban duration: 1 hour
bantime  = 3600
# Detection window: 10 minutes
findtime = 600
# Max failures before ban
maxretry = 5
# Use iptables for banning
banaction = iptables-multiport

# ─── OpenClaw WebSocket Gateway ───────────────────────────────────────────────
[openclaw-gateway]
enabled  = true
port     = 18790
filter   = openclaw-gateway
logpath  = /var/log/clawsentinel/access.log
maxretry = 10
bantime  = 1800

# ─── ClawEye Dashboard ────────────────────────────────────────────────────────
[claweye-dashboard]
enabled  = true
port     = 7432
filter   = claweye-dashboard
logpath  = /var/log/clawsentinel/access.log
maxretry = 5
bantime  = 3600

# ─── SSH (standard protection) ────────────────────────────────────────────────
[sshd]
enabled  = true
port     = ssh
filter   = sshd
logpath  = /var/log/auth.log
maxretry = 3
bantime  = 86400    # 24 hours for SSH

# ─── Traefik access log ────────────────────────────────────────────────────────
[traefik-auth]
enabled  = true
port     = 443
filter   = traefik-auth
logpath  = /var/log/traefik/access.log
maxretry = 5
bantime  = 3600
