{
  "_comment": "ClawBox hardened defaults â€” applied on clawsentinel init. Original config is backed up.",
  "_version": "0.1.0",

  "gatewayPort": 18790,
  "internalPort": 18789,

  "dmPolicy": "paired",

  "canvas": {
    "enabled": true,
    "contentSecurityPolicy": "default-src 'none'; script-src 'none'; style-src 'self'; img-src 'self' data:"
  },

  "tools": {
    "invoke": {
      "requireAuthToken": true,
      "rateLimit": {
        "windowMs": 60000,
        "max": 100
      }
    },
    "shell": {
      "allowlist": ["echo", "ls", "cat", "pwd", "date", "whoami", "uname"],
      "denylist": ["curl", "wget", "nc", "ncat", "nmap", "python", "python3", "ruby", "perl", "bash", "sh", "zsh", "fish", "dd", "mkfifo"]
    },
    "filesystem": {
      "deniedPaths": [
        "~/.ssh",
        "~/.aws",
        "~/.gnupg",
        "~/.kube",
        "~/.docker",
        "~/Library/Keychains",
        "/etc/passwd",
        "/etc/shadow",
        "/etc/sudoers",
        "/var/log",
        "/usr",
        "/bin",
        "/sbin",
        "/boot",
        "/sys",
        "/proc"
      ],
      "maxFileSizeBytes": 10485760
    },
    "memory": {
      "requireExplicitSave": true,
      "maxMemorySizeBytes": 1048576,
      "allowedWritePatterns": []
    }
  },

  "network": {
    "allowOutbound": false,
    "allowedDomains": [
      "api.anthropic.com",
      "api.openai.com",
      "generativelanguage.googleapis.com",
      "clawhub.ai"
    ]
  },

  "logging": {
    "auditAll": true,
    "retentionDays": 30
  }
}
